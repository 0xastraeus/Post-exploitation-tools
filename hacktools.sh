#!/bin/bash
# Install post exploitation enumeration scripts/tools
#
#########################################################################
# ////LINUX\\\\
# LSE: https://github.com/diego-treitos/linux-smart-enumeration
# LinuxPrivChecker: https://github.com/sleventyeleven/linuxprivchecker
# Pspy: https://github.com/DominicBreuker/pspy
# LinEnum: https://github.com/rebootuser/LinEnum
# linPEAS: https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS
#
# ////WINDOWS\\\\
# Windows-Exploit-Suggester: https://github.com/AonCyberLabs/Windows-Exploit-Suggester
# winPEAS: https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
# J.A.W.S: https://github.com/411Hall/JAWS
# WindowsEnum: https://github.com/absolomb/WindowsEnum
# PrintSpoofer: https://github.com/itm4n/PrintSpoofer.git
#
#########################################################################


PS3='Please select an option: '

# Checking if git is installed
if ! [ -x "$(command -v git)" ]; then
	echo -e 'Error: git is not installed.\n' >&2
	echo -e "You can install git using:\n\tsudo apt-get install git"
	exit 1
else
	echo -e "Creating $HOME/posttools/(linux_tools,windows_tools) folders...\ntools will be downloaded into their respective folders."
	mkdir -p $HOME/posttools/{linux_tools,windows_tools}
fi

sep=$(printf "%55s");echo -e ${sep// /=} "\n" 

# Linux post enumeration tools selection
linuxOptions () {
	options=("LinEnum" "LinuxPrivChecker" "Linux Smart Enumeration" "pspy" "LinPEAS" "Exit")
	select opt in "${options[@]}"; do
		case $opt in
			"LinEnum")
				echo "Getting linenum.sh..."
				wget "https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh" -P $HOME/posttools/linux_tool &> /dev/null
				echo -e "Done\n"
				linuxOptions
				;;

			"LinuxPrivChecker")
				echo "Getting LinuxPrivChecker.py..."
				wget "https://raw.githubusercontent.com/sleventyeleven/linuxprivchecker/master/linuxprivchecker.py" -P $HOME/posttools/linux_tools &> /dev/null
				echo -e "Done\n"
				linuxOptions
				;;

			"Linux Smart Enumeration")
				echo "Getting lse.sh..."
				wget "https://github.com/diego-treitos/linux-smart-enumeration/raw/master/lse.sh" -P $HOME/posttools/linux_tools &> /dev/null
				echo -e "Done\n"
				linuxOptions
				;;

			"pspy")
				echo "Getting pspy32..."
				wget "https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy32" -P $HOME/posttools/linux_tools &> /dev/null
				echo "Done"
				echo "Getting pspy64..."
				wget "https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64" -P $HOME/posttools/linux_tools &> /dev/null
				echo -e "Done\n"
				linuxOptions
				;;

			"LinPEAS")
				echo "Getting linpeas.sh..."
				wget "https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/linPEAS/linpeas.sh" -P $HOME/posttools/linux_tools &> /dev/null
				echo -e "Done\n"
				linuxOptions
				;;

			"Exit")
				main
				;;

			*) echo "invalid option $REPLY";;
		esac
	done
}

# Windows post enumeration tools selection
windowsOptions () {
	options=("Windows-Exploit-Suggester" "winPEAS" "J.A.W.S" "PrintSpoofer(Used if SeImpersonatePrivilege is enabled)" "WindowsENUM" "Exit")
	select opt in "${options[@]}"; do
		case $opt in
			"Windows-Exploit-Suggester")
				echo "Getting windows-exploit-suggester.py..."
				wget "https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py" -P $HOME/posttools/windows_tools &> /dev/null
				echo -e"Done\n"
				windowsOptions
				;;

			"winPEAS")
				echo "Getting winPEASx64.exe..."
				wget "https://github.com/carlospolop/PEASS-ng/raw/master/winPEAS/winPEASexe/binaries/x64/Release/winPEASx64.exe" -P $HOME/posttools/windows_tools &> /dev/null
				echo -e 'Done\n'
				echo "Getting winPEASx86.exe..."
				wget "https://github.com/carlospolop/PEASS-ng/raw/master/winPEAS/winPEASexe/binaries/x86/Release/winPEASx86.exe" -P $HOME/posttools/windows_tools &> /dev/null
				echo -e 'Done\n'
				windowsOptions
				;;

			"J.A.W.S")
				echo "Getting jaws-enum.ps1..."
				wget "https://raw.githubusercontent.com/411Hall/JAWS/master/jaws-enum.ps1" -P $HOME/posttools/windows_tools &> /dev/null
				echo -e "Done\n"
				windowsOptions
				;;

			"WindowsENUM")
				echo "Getting WindowsEnum.ps1"
				wget "https://raw.githubusercontent.com/absolomb/WindowsEnum/master/WindowsEnum.ps1" -P $HOME/posttools/windows_tools &> /dev/null
				echo -e "Done\n"
				windowsOptions
				;;

			"PrintSpoofer(Used if SeImpersonatePrivilege is enabled)")
				echo "Getting PrintSpoofer repository"
				git -C $HOME/posttools/windows_tools clone https://github.com/itm4n/PrintSpoofer.git &> /dev/null
				echo -e "Done\n"
				windowsOptions
				;;

			"Exit")
				main
				;;

			*) echo "invalid option $REPLY";;
		esac
	done
}

# Main menu
main (){
	options=("Linux" "Windows" "Quit")
		select opt in "${options[@]}"; do
			case $opt in
				"Linux")
					linuxOptions
					;;
				"Windows")
					windowsOptions
					;;
				"Quit")
					exit
					;;
	        	*) echo "invalid option $REPLY";;
	    	esac
		done
}

main